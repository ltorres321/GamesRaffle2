(()=>{var e={};e.id=937,e.ids=[937],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2518:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>f,tree:()=>c});var r=s(7096),a=s(6132),i=s(7284),n=s.n(i),o=s(2564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=["",{children:["auth",{children:["verify",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,385)),"/workspaces/GamesRaffle2/frontend/src/app/auth/verify/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,2540)),"/workspaces/GamesRaffle2/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/workspaces/GamesRaffle2/frontend/src/app/auth/verify/page.tsx"],m="/auth/verify/page",u={require:s,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/auth/verify/page",pathname:"/auth/verify",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},259:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,3579,23)),Promise.resolve().then(s.t.bind(s,619,23)),Promise.resolve().then(s.t.bind(s,1459,23)),Promise.resolve().then(s.t.bind(s,3456,23)),Promise.resolve().then(s.t.bind(s,847,23)),Promise.resolve().then(s.t.bind(s,7303,23))},8952:(e,t,s)=>{Promise.resolve().then(s.bind(s,5256)),Promise.resolve().then(s.bind(s,6837))},9680:(e,t,s)=>{Promise.resolve().then(s.bind(s,8643))},8643:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(3854),a=s(4218),i=s(1018),n=s(5548),o=s.n(n),l=s(4559);function c(){let e=(0,i.useRouter)(),[t,s]=(0,a.useState)(""),[n,c]=(0,a.useState)(""),[d,m]=(0,a.useState)({}),[u,f]=(0,a.useState)({}),[h,x]=(0,a.useState)({}),[g,p]=(0,a.useState)(null),[y,S]=(0,a.useState)({});(0,a.useEffect)(()=>{let t=localStorage.getItem("accessToken");if(!t){e.push("/auth/login");return}v()},[]),(0,a.useEffect)(()=>{let e=[];return Object.keys(y).forEach(t=>{if(y[t]>0){let s=setInterval(()=>{S(e=>({...e,[t]:Math.max(0,e[t]-1)}))},1e3);e.push(s)}}),()=>e.forEach(clearInterval)},[y]);let v=async()=>{try{let e=await l.Z.getMe();e.success&&e.data&&p(e.data.user)}catch(e){console.error("Failed to fetch user info:",e)}},N=async()=>{if(!t.trim()){m(e=>({...e,email:"Please enter the verification code"}));return}x(e=>({...e,email:!0})),m(e=>({...e,email:""}));try{let r=await l.Z.verifyEmail(t);r.success?(f(e=>({...e,email:"Email verified successfully!"})),s(""),await v(),r.data?.canAccessSite&&setTimeout(()=>{e.push("/")},2e3)):m(e=>({...e,email:r.message||"Invalid verification code"}))}catch(e){m(e=>({...e,email:"Network error. Please try again."}))}finally{x(e=>({...e,email:!1}))}},E=async()=>{if(!n.trim()){m(e=>({...e,sms:"Please enter the verification code"}));return}x(e=>({...e,sms:!0})),m(e=>({...e,sms:""}));try{let t=await l.Z.verifyPhone(n);t.success?(f(e=>({...e,sms:"Phone verified successfully!"})),c(""),await v(),t.data?.canAccessSite&&setTimeout(()=>{e.push("/")},2e3)):m(e=>({...e,sms:t.message||"Invalid verification code"}))}catch(e){m(e=>({...e,sms:"Network error. Please try again."}))}finally{x(e=>({...e,sms:!1}))}},b=async()=>{x(e=>({...e,resendEmail:!0}));try{let e=await l.Z.resendEmailVerification();e.success?(f(e=>({...e,resendEmail:"Verification email sent!"})),S(e=>({...e,email:60}))):m(t=>({...t,resendEmail:e.message||"Failed to send email"}))}catch(e){m(e=>({...e,resendEmail:"Network error. Please try again."}))}finally{x(e=>({...e,resendEmail:!1}))}},j=async()=>{x(e=>({...e,resendSMS:!0}));try{let e=await l.Z.resendSmsVerification();e.success?(f(e=>({...e,resendSMS:"Verification code sent!"})),S(e=>({...e,sms:60}))):m(t=>({...t,resendSMS:e.message||"Failed to send SMS"}))}catch(e){m(e=>({...e,resendSMS:"Network error. Please try again."}))}finally{x(e=>({...e,resendSMS:!1}))}};if(!g)return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-green-900 to-gray-900 flex items-center justify-center",children:r.jsx("div",{className:"text-white",children:"Loading..."})});let P=g.emailVerified||u.email,T=g.phoneVerified||u.sms,w=P&&T,I=P||T;return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-green-900 to-gray-900 flex items-center justify-center px-4 py-12",children:r.jsx("div",{className:"max-w-md w-full",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Verify Your Account"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Complete verification to access all features"})]}),I&&r.jsx("div",{className:"mb-6 p-4 bg-green-100 border border-green-300 text-green-700 rounded-md",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{className:"font-medium",children:w?"Account fully verified! Redirecting to home page...":"Account verified! You can now access the site. Redirecting..."})]})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Email Verification"}),P?r.jsx("span",{className:"text-green-600 font-medium",children:"✓ Verified"}):r.jsx("span",{className:"text-yellow-600 font-medium",children:"⚠ Pending"})]}),!P&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["We sent a verification code to ",r.jsx("strong",{children:g.email})]}),(0,r.jsxs)("div",{children:[r.jsx("input",{type:"text",placeholder:"Enter email verification code",value:t,onChange:e=>s(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-600"}),d.email&&r.jsx("p",{className:"text-red-600 text-xs mt-1",children:d.email}),u.email&&r.jsx("p",{className:"text-green-600 text-xs mt-1",children:u.email})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:N,disabled:h.email,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-600 disabled:opacity-50",children:h.email?"Verifying...":"Verify Email"}),r.jsx("button",{onClick:b,disabled:h.resendEmail||y.email>0,className:"px-4 py-2 text-green-600 hover:text-green-500 text-sm disabled:opacity-50",children:y.email>0?`Resend (${y.email}s)`:h.resendEmail?"Sending...":"Resend"})]}),d.resendEmail&&r.jsx("p",{className:"text-red-600 text-xs",children:d.resendEmail}),u.resendEmail&&r.jsx("p",{className:"text-green-600 text-xs",children:u.resendEmail})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Phone Verification"}),T?r.jsx("span",{className:"text-green-600 font-medium",children:"✓ Verified"}):r.jsx("span",{className:"text-yellow-600 font-medium",children:"⚠ Pending"})]}),!T&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["We sent a 6-digit code to ",r.jsx("strong",{children:g.phoneNumber})]}),(0,r.jsxs)("div",{children:[r.jsx("input",{type:"text",placeholder:"Enter 6-digit SMS code",value:n,onChange:e=>c(e.target.value),maxLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-600"}),d.sms&&r.jsx("p",{className:"text-red-600 text-xs mt-1",children:d.sms}),u.sms&&r.jsx("p",{className:"text-green-600 text-xs mt-1",children:u.sms})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:E,disabled:h.sms,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-600 disabled:opacity-50",children:h.sms?"Verifying...":"Verify Phone"}),r.jsx("button",{onClick:j,disabled:h.resendSMS||y.sms>0,className:"px-4 py-2 text-green-600 hover:text-green-500 text-sm disabled:opacity-50",children:y.sms>0?`Resend (${y.sms}s)`:h.resendSMS?"Sending...":"Resend"})]}),d.resendSMS&&r.jsx("p",{className:"text-red-600 text-xs",children:d.resendSMS}),u.resendSMS&&r.jsx("p",{className:"text-green-600 text-xs",children:u.resendSMS})]})]}),!I&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 mb-6",children:(0,r.jsxs)("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:"Verification Required:"})," Please complete email OR phone verification to access the site."]})}),I&&!w&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3 mb-6",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800",children:[r.jsx("strong",{children:"Optional:"})," Complete ",P?"phone":"email"," verification for enhanced security. You can do this later from your profile page."]})}),r.jsx("div",{className:"text-center",children:r.jsx(o(),{href:"/",className:"text-green-600 hover:text-green-500 font-medium",children:"Continue to Games Raffle"})})]})})})}},9812:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r={BASE_URL:"https://gamesraffle2.onrender.com",ENDPOINTS:{AUTH:{REGISTER:"/api/auth/register",LOGIN:"/api/auth/login",LOGOUT:"/api/auth/logout",REFRESH:"/api/auth/refresh",ME:"/api/auth/me",VERIFY:"/api/auth/verify",VERIFY_EMAIL:"/api/auth/verify-email",VERIFY_PHONE:"/api/auth/verify-phone",RESEND_EMAIL:"/api/auth/resend-email-verification",RESEND_SMS:"/api/auth/resend-sms-verification",CHANGE_PASSWORD:"/api/auth/password"},USERS:{PROFILE:"/api/users/profile",UPDATE_PROFILE:"/api/users/profile"},GAMES:{LIST:"/api/games",DETAIL:"/api/games/:id",JOIN:"/api/games/:id/join"},PICKS:{SUBMIT:"/api/picks",HISTORY:"/api/picks/history"}}}},6837:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AuthProvider:()=>l,useAuth:()=>c,useRequireAuth:()=>m,withAuth:()=>d});var r=s(3854),a=s(4218),i=s(1018),n=s(9812);let o=(0,a.createContext)(void 0);function l({children:e}){let[t,s]=(0,a.useState)(null),[l,c]=(0,a.useState)(!0),d=(0,i.useRouter)();(0,a.useEffect)(()=>{m()},[]);let m=async()=>{try{let e=localStorage.getItem("accessToken");if(!e){c(!1);return}let t=await fetch(`${n.Z.BASE_URL}${n.Z.ENDPOINTS.AUTH.VERIFY}`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();e.authenticated?s(e.data.user):(localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("sessionId"))}else 401===t.status&&await u()}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("sessionId")}finally{c(!1)}},u=async()=>{try{let e=localStorage.getItem("refreshToken");if(!e)return!1;let t=await fetch(`${n.Z.BASE_URL}${n.Z.ENDPOINTS.AUTH.REFRESH}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(t.ok){let e=await t.json();return localStorage.setItem("accessToken",e.data.tokens.accessToken),localStorage.setItem("refreshToken",e.data.tokens.refreshToken),await m(),!0}}catch(e){console.error("Token refresh failed:",e)}return!1},f=async(e,t)=>{try{let r=await fetch(`${n.Z.BASE_URL}${n.Z.ENDPOINTS.AUTH.LOGIN}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await r.json();if(a.success)return localStorage.setItem("accessToken",a.data.tokens.accessToken),localStorage.setItem("refreshToken",a.data.tokens.refreshToken),localStorage.setItem("sessionId",a.data.tokens.sessionId),s(a.data.user),c(!1),!0;return!1}catch(e){return console.error("Login failed:",e),!1}},h=async()=>{try{let e=localStorage.getItem("accessToken"),t=localStorage.getItem("sessionId");e&&await fetch(`${n.Z.BASE_URL}${n.Z.ENDPOINTS.AUTH.LOGOUT}`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({sessionId:t})})}catch(e){console.error("Logout API call failed:",e)}localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("sessionId"),s(null),d.push("/")},x=async()=>{await m()};return r.jsx(o.Provider,{value:{user:t,isLoading:l,isAuthenticated:!!t,login:f,logout:h,refreshAuth:x},children:e})}function c(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function d(e,t={}){return function(s){let{user:n,isLoading:o,isAuthenticated:l}=c(),d=(0,i.useRouter)();return((0,a.useEffect)(()=>{if(!o){if(!l){d.push(t.redirectTo||"/auth/login");return}if(t.requireVerification&&!t.allowUnverified&&!n?.isVerified){d.push("/auth/verify");return}}},[o,l,n,d]),o)?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 via-green-900 to-gray-900",children:r.jsx("div",{className:"text-white text-lg",children:"Loading..."})}):l&&(!t.requireVerification||t.allowUnverified||n?.isVerified)?r.jsx(e,{...s}):null}}function m(e={}){let{user:t,isLoading:s,isAuthenticated:r}=c(),n=(0,i.useRouter)();return(0,a.useEffect)(()=>{if(!s){if(!r){n.push(e.redirectTo||"/auth/login");return}if(e.requireVerification&&!e.allowUnverified&&!t?.isVerified){n.push("/auth/verify");return}}},[s,r,t,n]),{user:t,isLoading:s,isAuthenticated:r,isVerified:t?.isVerified||!1,canMakePicks:r&&t?.isVerified,canDeposit:r&&t?.isVerified,canViewMyContests:r}}},4559:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(9812);class a{constructor(){this.baseUrl=r.Z.BASE_URL}async request(e,t={}){let s=`${this.baseUrl}${e}`,r={headers:{"Content-Type":"application/json",...t.headers},...t};try{let e=await fetch(s,r),t=await e.json();if(!e.ok)throw Error(t.message||`HTTP error! status: ${e.status}`);return t}catch(e){throw console.error("API request failed:",e),e}}async register(e){return this.request(r.Z.ENDPOINTS.AUTH.REGISTER,{method:"POST",body:JSON.stringify(e)})}async login(e){return this.request(r.Z.ENDPOINTS.AUTH.LOGIN,{method:"POST",body:JSON.stringify(e)})}async logout(e){return this.request(r.Z.ENDPOINTS.AUTH.LOGOUT,{method:"POST",body:JSON.stringify({sessionId:e})})}async getMe(){return this.request(r.Z.ENDPOINTS.AUTH.ME)}async verifyEmail(e){return this.request(r.Z.ENDPOINTS.AUTH.VERIFY_EMAIL,{method:"POST",body:JSON.stringify({token:e})})}async verifyPhone(e){return this.request(r.Z.ENDPOINTS.AUTH.VERIFY_PHONE,{method:"POST",body:JSON.stringify({code:e})})}async resendEmailVerification(){return this.request(r.Z.ENDPOINTS.AUTH.RESEND_EMAIL,{method:"POST"})}async resendSmsVerification(){return this.request(r.Z.ENDPOINTS.AUTH.RESEND_SMS,{method:"POST"})}async refreshToken(e){return this.request(r.Z.ENDPOINTS.AUTH.REFRESH,{method:"POST",body:JSON.stringify({refreshToken:e})})}}let i=new a},385:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var r=s(5153);let a=(0,r.createProxy)(String.raw`/workspaces/GamesRaffle2/frontend/src/app/auth/verify/page.tsx`),{__esModule:i,$$typeof:n}=a,o=a.default,l=o},2540:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f,metadata:()=>u});var r=s(4656),a=s(177),i=s.n(a);s(5023);var n=s(8204),o=s(5153);let l=(0,o.createProxy)(String.raw`/workspaces/GamesRaffle2/frontend/src/contexts/AuthContext.tsx`),{__esModule:c,$$typeof:d}=l;l.default;let m=(0,o.createProxy)(String.raw`/workspaces/GamesRaffle2/frontend/src/contexts/AuthContext.tsx#AuthProvider`);(0,o.createProxy)(String.raw`/workspaces/GamesRaffle2/frontend/src/contexts/AuthContext.tsx#useAuth`),(0,o.createProxy)(String.raw`/workspaces/GamesRaffle2/frontend/src/contexts/AuthContext.tsx#withAuth`),(0,o.createProxy)(String.raw`/workspaces/GamesRaffle2/frontend/src/contexts/AuthContext.tsx#useRequireAuth`);let u={title:"Games Raffle - Win Big Prizes",description:"The ultimate NFL survivor contest platform with amazing prizes from top vendors",keywords:"NFL, survivor, contest, sports betting, prizes, cars, vacations, games raffle"};function f({children:e}){return r.jsx("html",{lang:"en",className:"dark",children:(0,r.jsxs)("body",{className:`${i().className} bg-dark-900 text-white min-h-screen`,children:[r.jsx(m,{children:r.jsx("div",{className:"min-h-screen bg-gradient-dark",children:e})}),r.jsx(n.x7,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#1e293b",color:"#ffffff",border:"1px solid #22c55e"},success:{iconTheme:{primary:"#22c55e",secondary:"#ffffff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#ffffff"}}}})]})})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[271,548],()=>s(2518));module.exports=r})();